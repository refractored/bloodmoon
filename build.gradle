/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.4.2/samples
 */
plugins {
    id "com.github.johnrengelman.shadow" version "7.1.2"
    id "java"
}

sourceCompatibility = 17
targetCompatibility = 17

repositories {
    mavenCentral()

    maven { url = "https://jitpack.io/" }

    // Spigot
    maven { url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/' }
    maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
    maven { url = 'https://oss.sonatype.org/content/repositories/central' }
    maven { url = 'https://maven.enginehub.org/repo/' }
    maven { url = 'https://repo.extendedclip.com/content/repositories/placeholderapi/' }
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

dependencies {

    def lamp_version = "3.1.8"

    // Required for all platforms
    implementation("com.github.Revxrsal.Lamp:common:${lamp_version}")
    compileOnly("com.willfp:eco:6.55.0")
    // The Bukkit API for Lamp
    implementation("com.github.Revxrsal.Lamp:bukkit:${lamp_version}")

    implementation 'org.apache.commons:commons-lang3:3.14.0'
    compileOnly 'org.spigotmc:spigot-api:1.20.4-R0.1-SNAPSHOT'
    compileOnly 'com.sk89q.worldguard:worldguard-bukkit:7.0.0'
    compileOnly 'me.clip:placeholderapi:2.11.5'
    implementation 'org.yaml:snakeyaml:1.23'
    implementation 'org.jetbrains:annotations:18.0.0'
    compileOnly("net.kyori:adventure-platform-bukkit:4.1.2")
    implementation (files ('libs/SQLAccess.jar') )
}

jar {
    from {
        configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
    }

    destinationDirectory.set(file("exes/server/plugins"))
}

compileJava {
    options.compilerArgs += ["-parameters"]
}


task runSpigot(type: Exec) {
    standardInput = System.in

    workingDir 'exes/server'
    commandLine 'cmd', '/c', 'java', '-jar', file('exes/paper.jar'), 'nogui'
}